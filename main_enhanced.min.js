let currentLanguage="ar",currentTheme="light",isScrolling=!1,animationFrameId=null,elements={loadingScreen:document.getElementById("loading-screen"),navbar:document.getElementById("navbar"),navMenu:document.getElementById("nav-menu"),hamburger:document.getElementById("hamburger"),langToggle:document.getElementById("lang-toggle"),langText:document.getElementById("lang-text"),themeToggle:document.getElementById("theme-toggle"),backToTop:document.getElementById("back-to-top"),contactForm:document.getElementById("contact-form"),skillBars:document.querySelectorAll(".skill-progress"),navLinks:document.querySelectorAll(".nav-link"),statNumbers:document.querySelectorAll(".stat-number"),projectCards:document.querySelectorAll(".project-card"),testimonialCards:document.querySelectorAll(".testimonial-card"),blogCards:document.querySelectorAll(".blog-card"),interestCategories:document.querySelectorAll(".interest-category")},translations={ar:{direction:"rtl",font:"Tajawal"},en:{direction:"ltr",font:"Poppins"}},utils={scrollToElement:(e,t=80)=>{var e=document.getElementById(e);e&&(e=e.offsetTop-t,window.scrollTo({top:e,behavior:"smooth"}))},throttle:(t,a)=>{let n;return function(){var e=arguments;n||(t.apply(this,e),n=!0,setTimeout(()=>n=!1,a))}},debounce:(a,n,r=!1)=>{let o;return function(...e){var t=r&&!o;clearTimeout(o),o=setTimeout(()=>{o=null,r||a(...e)},n),t&&a(...e)}},isInViewport:(e,t=.1)=>{var e=e.getBoundingClientRect(),a=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth,a=e.top<=a*(1-t)&&e.top+e.height>=a*t,e=e.left<=n*(1-t)&&e.left+e.width>=n*t;return a&&e},animateNumber:(a,n,r,o,s="")=>{let l=performance.now(),i=e=>{var e=e-l,e=Math.min(e/o,1),t=(t=e,1- --t*t*t*t),t=Math.floor(n+(r-n)*t);a.textContent=t+s,e<1&&requestAnimationFrame(i)};requestAnimationFrame(i)},randomInRange:(e,t)=>Math.random()*(t-e)+e,formatDate:e=>new Date(e).toLocaleDateString("ar"===currentLanguage?"ar-EG":"en-US",{year:"numeric",month:"long",day:"numeric"}),isValidEmail:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),showNotification:(e,t="success",a=3e3)=>{let n=document.createElement("div");n.className="notification notification-"+t,n.textContent=e,n.style.cssText=`
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            background: ${"success"===t?"#10b981":"error"===t?"#ef4444":"#3b82f6"};
            color: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            z-index: 9999;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        `,document.body.appendChild(n),setTimeout(()=>{n.style.transform="translateX(0)"},100),setTimeout(()=>{n.style.transform="translateX(100%)",setTimeout(()=>{document.body.removeChild(n)},300)},a)}},loadingScreen={init:()=>{let e=0,t=setInterval(()=>{100<=(e+=utils.randomInRange(5,15))&&(e=100,clearInterval(t),loadingScreen.hide())},100);setTimeout(()=>{clearInterval(t),loadingScreen.hide()},3e3)},hide:()=>{elements.loadingScreen&&(elements.loadingScreen.classList.add("hidden"),setTimeout(()=>{elements.loadingScreen.style.display="none","undefined"!=typeof AOS&&AOS.init({duration:800,easing:"ease-out-cubic",once:!0,offset:100})},500))}},navigation={init:()=>{navigation.setupScrollEffect(),navigation.setupMobileMenu(),navigation.setupSmoothScrolling(),navigation.setupActiveLinks(),navigation.setupKeyboardNavigation()},setupScrollEffect:()=>{let t=window.scrollY;var e=utils.throttle(()=>{var e=window.scrollY;50<e?elements.navbar.classList.add("scrolled"):elements.navbar.classList.remove("scrolled"),e>t&&100<e?elements.navbar.style.transform="translateY(-100%)":elements.navbar.style.transform="translateY(0)",t=e},10);window.addEventListener("scroll",e)},setupMobileMenu:()=>{elements.hamburger&&elements.navMenu&&(elements.hamburger.addEventListener("click",()=>{var e=elements.hamburger.classList.contains("active");elements.hamburger.classList.toggle("active"),elements.navMenu.classList.toggle("active"),document.body.style.overflow=e?"auto":"hidden"}),elements.navLinks.forEach(e=>{e.addEventListener("click",()=>{elements.hamburger.classList.remove("active"),elements.navMenu.classList.remove("active"),document.body.style.overflow="auto"})}),document.addEventListener("click",e=>{!elements.navbar.contains(e.target)&&elements.navMenu.classList.contains("active")&&(elements.hamburger.classList.remove("active"),elements.navMenu.classList.remove("active"),document.body.style.overflow="auto")}),document.addEventListener("keydown",e=>{"Escape"===e.key&&elements.navMenu.classList.contains("active")&&(elements.hamburger.classList.remove("active"),elements.navMenu.classList.remove("active"),document.body.style.overflow="auto")}))},setupSmoothScrolling:()=>{elements.navLinks.forEach(a=>{a.addEventListener("click",e=>{e.preventDefault();var t=a.getAttribute("href").substring(1);utils.scrollToElement(t),navigation.createRipple(e,a)})})},setupActiveLinks:()=>{let e=document.querySelectorAll("section[id]");var t=utils.throttle(()=>{let a="";e.forEach(e=>{var t=e.offsetTop-150;window.scrollY>=t&&window.scrollY<t+e.clientHeight&&(a=e.getAttribute("id"))}),elements.navLinks.forEach(e=>{e.classList.remove("active"),e.getAttribute("href")==="#"+a&&e.classList.add("active")})},100);window.addEventListener("scroll",t)},setupKeyboardNavigation:()=>{elements.navLinks.forEach(t=>{t.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.click())})})},createRipple:(e,t)=>{let a=document.createElement("span");var n=t.getBoundingClientRect(),r=Math.max(n.width,n.height),o=e.clientX-n.left-r/2,e=e.clientY-n.top-r/2;a.style.cssText=`
            position: absolute;
            width: ${r}px;
            height: ${r}px;
            left: ${o}px;
            top: ${e}px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: scale(0);
            animation: ripple 0.6s linear;
            pointer-events: none;
        `,t.style.position="relative",t.style.overflow="hidden",t.appendChild(a),setTimeout(()=>{a.remove()},600)}},languageToggle={init:()=>{var e=localStorage.getItem("portfolio-language")||"ar";languageToggle.setLanguage(e),elements.langToggle&&elements.langToggle.addEventListener("click",languageToggle.toggle)},toggle:()=>{var e="ar"===currentLanguage?"en":"ar";languageToggle.setLanguage(e),document.body.style.transition="opacity 0.3s ease",document.body.style.opacity="0.8",setTimeout(()=>{document.body.style.opacity="1",setTimeout(()=>{document.body.style.transition=""},300)},150)},setLanguage:a=>{currentLanguage=a,document.documentElement.lang=a,document.documentElement.dir=translations[a].direction,document.body.className=document.body.className.replace(/lang-\w+/,""),document.body.classList.add("lang-"+a),elements.langText&&(elements.langText.textContent="ar"===a?"EN":"ع"),document.querySelectorAll("[data-ar][data-en]").forEach(e=>{var t=e.getAttribute("data-"+a);t&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName?e.placeholder=t:e.textContent=t)}),localStorage.setItem("portfolio-language",a),document.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:a}}))}},themeToggle={init:()=>{var e=localStorage.getItem("portfolio-theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");themeToggle.setTheme(e),elements.themeToggle&&elements.themeToggle.addEventListener("click",themeToggle.toggle),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("portfolio-theme")||themeToggle.setTheme(e.matches?"dark":"light")})},toggle:()=>{var e="light"===currentTheme?"dark":"light";themeToggle.setTheme(e),document.documentElement.style.transition="background-color 0.3s ease, color 0.3s ease",setTimeout(()=>{document.documentElement.style.transition=""},300)},setTheme:e=>{var t;currentTheme=e,document.documentElement.setAttribute("data-theme",e),elements.themeToggle&&(t=elements.themeToggle.querySelector("i"))&&(t.className="light"===e?"fas fa-moon":"fas fa-sun"),localStorage.setItem("portfolio-theme",e),document.dispatchEvent(new CustomEvent("themeChanged",{detail:{theme:e}}))}},skillsAnimation={init:()=>{skillsAnimation.setupIntersectionObserver()},setupIntersectionObserver:()=>{let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(skillsAnimation.animateSkillBars(e.target),t.unobserve(e.target))})},{threshold:.5});var e=document.getElementById("skills");e&&t.observe(e)},animateSkillBars:e=>{e.querySelectorAll(".skill-progress").forEach((a,e)=>{setTimeout(()=>{var e=a.getAttribute("data-width");a.style.width=e+"%";var t=a.closest(".skill-item").querySelector(".skill-percentage");t&&utils.animateNumber(t,0,parseInt(e),1500,"%")},200*e)})}},statisticsAnimation={init:()=>{statisticsAnimation.setupIntersectionObserver()},setupIntersectionObserver:()=>{let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(statisticsAnimation.animateNumbers(e.target),t.unobserve(e.target))})},{threshold:.5});elements.statNumbers.forEach(e=>{t.observe(e)})},animateNumbers:e=>{var t=e.textContent,a=parseInt(t.replace(/\D/g,"")),t=t.replace(/\d/g,"");utils.animateNumber(e,0,a,2e3,t)}},contactForm={init:()=>{elements.contactForm&&(contactForm.setupFormValidation(),contactForm.setupFormSubmission(),contactForm.setupFloatingLabels())},setupFormValidation:()=>{elements.contactForm.querySelectorAll("input, textarea").forEach(e=>{e.addEventListener("blur",()=>contactForm.validateField(e)),e.addEventListener("input",()=>contactForm.clearErrors(e))})},validateField:e=>{var t=e.value.trim();let a=!0,n="";switch(contactForm.clearErrors(e),e.type){case"email":t?utils.isValidEmail(t)||(n="ar"===currentLanguage?"البريد الإلكتروني غير صحيح":"Invalid email format",a=!1):(n="ar"===currentLanguage?"البريد الإلكتروني مطلوب":"Email is required",a=!1);break;case"text":t?t.length<2&&(n="ar"===currentLanguage?"يجب أن يكون أكثر من حرفين":"Must be at least 2 characters",a=!1):(n="ar"===currentLanguage?"هذا الحقل مطلوب":"This field is required",a=!1);break;default:t||(n="ar"===currentLanguage?"هذا الحقل مطلوب":"This field is required",a=!1)}return a||contactForm.showError(e,n),a},showError:(e,t)=>{e.classList.add("error");let a=e.parentNode.querySelector(".error-message");a||((a=document.createElement("span")).className="error-message",a.style.cssText=`
                color: #ef4444;
                font-size: 0.875rem;
                margin-top: 0.25rem;
                display: block;
            `,e.parentNode.appendChild(a)),a.textContent=t},clearErrors:e=>{e.classList.remove("error");e=e.parentNode.querySelector(".error-message");e&&e.remove()},setupFormSubmission:()=>{elements.contactForm.addEventListener("submit",e=>{e.preventDefault();var e=new FormData(elements.contactForm),t=elements.contactForm.querySelectorAll("input, textarea");let a=!0;t.forEach(e=>{contactForm.validateField(e)||(a=!1)}),a?contactForm.submitForm(e):utils.showNotification("ar"===currentLanguage?"يرجى تصحيح الأخطاء في النموذج":"Please correct the errors in the form","error")})},submitForm:async e=>{var t=elements.contactForm.querySelector('button[type="submit"]'),a=t.innerHTML;t.innerHTML=`
            <i class="fas fa-spinner fa-spin"></i>
            <span>${"ar"===currentLanguage?"جاري الإرسال...":"Sending..."}</span>
        `,t.disabled=!0;try{await new Promise(e=>setTimeout(e,2e3)),utils.showNotification("ar"===currentLanguage?"تم إرسال رسالتك بنجاح!":"Your message has been sent successfully!","success"),elements.contactForm.reset()}catch(e){utils.showNotification("ar"===currentLanguage?"حدث خطأ في إرسال الرسالة":"An error occurred while sending the message","error")}finally{t.innerHTML=a,t.disabled=!1}},setupFloatingLabels:()=>{elements.contactForm.querySelectorAll(".form-group").forEach(e=>{let t=e.querySelector("input, textarea"),a=e.querySelector("label");t&&a&&(t.value&&a.classList.add("active"),t.addEventListener("focus",()=>{a.classList.add("active")}),t.addEventListener("blur",()=>{t.value||a.classList.remove("active")}))})}},backToTop={init:()=>{elements.backToTop&&(backToTop.setupScrollListener(),backToTop.setupClickHandler())},setupScrollListener:()=>{var e=utils.throttle(()=>{300<window.scrollY?elements.backToTop.classList.add("visible"):elements.backToTop.classList.remove("visible")},100);window.addEventListener("scroll",e)},setupClickHandler:()=>{elements.backToTop.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}},parallaxEffects={init:()=>{parallaxEffects.setupFloatingElements(),parallaxEffects.setupScrollParallax()},setupFloatingElements:()=>{document.querySelectorAll(".floating-element").forEach((a,e)=>{let n=.5+.2*e,r=20+10*e,o=()=>{var e=.001*Date.now(),t=Math.sin(e*n)*r,e=Math.cos(e*n*.5)*(.5*r);a.style.transform=`translate(${e}px, ${t}px)`,requestAnimationFrame(o)};o()})},setupScrollParallax:()=>{let e=document.querySelectorAll("[data-parallax]");var t=utils.throttle(()=>{let a=window.pageYOffset;e.forEach(e=>{var t=-.5*a;e.style.transform=`translateY(${t}px)`})},10);window.addEventListener("scroll",t)}},intersectionObserver={init:()=>{intersectionObserver.setupAnimationObserver(),intersectionObserver.setupLazyLoading()},setupAnimationObserver:()=>{let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animate-in"),e.target.classList.contains("project-card")?intersectionObserver.animateProjectCard(e.target):e.target.classList.contains("testimonial-card")&&intersectionObserver.animateTestimonialCard(e.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll(".project-card, .testimonial-card, .blog-card, .interest-category").forEach(e=>{t.observe(e)})},setupLazyLoading:()=>{let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&((e=e.target).src=e.dataset.src,e.classList.remove("lazy"),t.unobserve(e))})});document.querySelectorAll("img[data-src]").forEach(e=>{t.observe(e)})},animateProjectCard:e=>{let t=e.querySelector(".project-image img");e=e.querySelector(".project-content");t&&setTimeout(()=>{t.style.transform="scale(1.05)"},200),e&&e.querySelectorAll(".tech-tag").forEach((e,t)=>{setTimeout(()=>{e.style.transform="translateY(0)",e.style.opacity="1"},300+100*t)})},animateTestimonialCard:e=>{let t=e.querySelector(".testimonial-quote"),a=e.querySelector(".testimonial-text");t&&setTimeout(()=>{t.style.transform="scale(1.1) rotate(360deg)"},200),a&&setTimeout(()=>{a.style.opacity="1",a.style.transform="translateY(0)"},400)}},performanceMonitor={init:()=>{performanceMonitor.measurePageLoad(),performanceMonitor.setupFPSMonitor()},measurePageLoad:()=>{window.addEventListener("load",()=>{var e=performance.getEntriesByType("navigation")[0],e=e.loadEventEnd-e.loadEventStart;console.log(`Page load time: ${e}ms`),3e3<e&&console.warn("Page load time is slow")})},setupFPSMonitor:()=>{let a=performance.now(),n=0,r=e=>{var t;n++,e>=a+1e3&&((t=Math.round(1e3*n/(e-a)))<30&&console.warn("Low FPS detected: "+t),n=0,a=e),requestAnimationFrame(r)};requestAnimationFrame(r)}},errorHandler={init:()=>{window.addEventListener("error",errorHandler.handleError),window.addEventListener("unhandledrejection",errorHandler.handlePromiseRejection)},handleError:e=>{console.error("JavaScript Error:",e.error),"TypeError"!==e.error.name&&"ReferenceError"!==e.error.name||utils.showNotification("ar"===currentLanguage?"حدث خطأ تقني، يرجى إعادة تحميل الصفحة":"A technical error occurred, please reload the page","error",5e3)},handlePromiseRejection:e=>{console.error("Unhandled Promise Rejection:",e.reason),e.preventDefault()}},keyboardShortcuts={init:()=>{document.addEventListener("keydown",keyboardShortcuts.handleKeydown)},handleKeydown:e=>{(e.ctrlKey||e.metaKey)&&"k"===e.key&&e.preventDefault(),"Escape"===e.key&&elements.navMenu.classList.contains("active")&&(elements.hamburger.classList.remove("active"),elements.navMenu.classList.remove("active"),document.body.style.overflow="auto"),"Home"!==e.key||e.target.matches("input, textarea")||(e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})),"End"!==e.key||e.target.matches("input, textarea")||(e.preventDefault(),window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}))}},app={init:()=>{loadingScreen.init(),navigation.init(),languageToggle.init(),themeToggle.init(),skillsAnimation.init(),statisticsAnimation.init(),contactForm.init(),backToTop.init(),parallaxEffects.init(),intersectionObserver.init(),performanceMonitor.init(),errorHandler.init(),keyboardShortcuts.init(),document.addEventListener("languageChanged",app.handleLanguageChange),document.addEventListener("themeChanged",app.handleThemeChange),console.log("Portfolio website initialized successfully")},handleLanguageChange:e=>{console.log("Language changed to: "+e.detail.language)},handleThemeChange:e=>{console.log("Theme changed to: "+e.detail.theme)}},style=("loading"===document.readyState?document.addEventListener("DOMContentLoaded",app.init):app.init(),document.createElement("style"));style.textContent=`
    @keyframes ripple {
        to {
            transform: scale(4);
            opacity: 0;
        }
    }
    
    .animate-in {
        animation: slideInUp 0.6s ease-out forwards;
    }
    
    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .tech-tag {
        transform: translateY(20px);
        opacity: 0;
        transition: all 0.3s ease;
    }
    
    .testimonial-text {
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.5s ease;
    }
    
    .error {
        border-color: #ef4444 !important;
        box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
    }
    
    .form-group label.active {
        top: -0.5rem;
        font-size: 0.875rem;
        color: var(--primary-color);
    }
`,document.head.appendChild(style);